<!-- Dashboard des statistiques -->
<div class="dashboard-stats">
  <h2 class="stats-title">Statistiques en temps réel</h2>
  <div class="stats-grid">
    <div class="stat-card">
      <h3 class="stat-label">Total</h3>
      <p class="stat-value total">{{ todoService.todoStats().total }}</p>
    </div>
    <div class="stat-card">
      <h3 class="stat-label">Complétés</h3>
      <p class="stat-value completed">{{ todoService.todoStats().completed }}</p>
    </div>
    <div class="stat-card">
      <h3 class="stat-label">En cours</h3>
      <p class="stat-value in-progress">{{ todoService.todoStats().inProgress }}</p>
    </div>
    <div class="stat-card">
      <h3 class="stat-label">Priorité haute</h3>
      <p class="stat-value high-priority">{{ todoService.todoStats().highPriority }}</p>
    </div>
    <div class="stat-card">
      <h3 class="stat-label">Taux de complétion</h3>
      <p class="stat-value completion-rate">
        {{ todoService.todoStats().completionRate | number: '1.0-0' }}%
      </p>
    </div>
  </div>
</div>

<!-- Colonnes Kanban -->
<div class="kanban-board">
  <!-- À faire -->
  <div class="kanban-column">
    <h3 class="column-header">
      À faire
      <span class="column-count">({{ todoService.pendingTodos().length }})</span>
    </h3>
    <div class="todo-list">
      @for (todo of todoService.pendingTodos(); track todo.id) {
        <div
          class="todo-card todo-column"
          [appHighlight]="todo.priority === 'high' ? 'rgba(239, 68, 68, 0.1)' : 'transparent'"
          [appHighlightDelay]="todo.priority === 'high' ? 500 : 0"
        >
          <div class="todo-header">
            <h4 class="todo-title">{{ todo.title }}</h4>
            <span
              class="priority-badge"
              [class.high]="todo.priority === 'high'"
              [class.medium]="todo.priority === 'medium'"
              [class.low]="todo.priority === 'low'"
            >
              {{ todo.priority | priority }}
            </span>
          </div>
          @if (todo.description) {
            <p class="todo-description">{{ todo.description }}</p>
          }
          <div class="todo-footer">
            <span>Créé le {{ todo.createdAt | date: 'dd/MM/yyyy' }}</span>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- En cours -->
  <div class="kanban-column">
    <h3 class="column-header">
      En cours
      <span class="column-count">({{ todoService.inProgressTodos().length }})</span>
    </h3>
    <div class="todo-list">
      @for (todo of todoService.inProgressTodos(); track todo.id) {
        <div
          class="todo-card in-progress-column"
          [appHighlight]="todo.priority === 'high' ? 'rgba(239, 68, 68, 0.1)' : 'transparent'"
          [appHighlightDelay]="todo.priority === 'high' ? 500 : 0"
        >
          <div class="todo-header">
            <h4 class="todo-title">{{ todo.title }}</h4>
            <span
              class="priority-badge"
              [class.high]="todo.priority === 'high'"
              [class.medium]="todo.priority === 'medium'"
              [class.low]="todo.priority === 'low'"
            >
              {{ todo.priority | priority }}
            </span>
          </div>
          @if (todo.description) {
            <p class="todo-description">{{ todo.description }}</p>
          }
          <div class="todo-footer">
            <span>Mis à jour le {{ todo.updatedAt | date: 'dd/MM/yyyy' }}</span>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- Terminé -->
  <div class="kanban-column">
    <h3 class="column-header">
      Terminé
      <span class="column-count">({{ todoService.completedTodos().length }})</span>
    </h3>
    <div class="todo-list">
      @for (todo of todoService.completedTodos(); track todo.id) {
        <div
          class="todo-card done-column"
          [appHighlight]="todo.priority === 'high' ? 'rgba(34, 197, 94, 0.1)' : 'transparent'"
          [appHighlightDelay]="todo.priority === 'high' ? 500 : 0"
        >
          <div class="todo-header">
            <h4 class="todo-title line-through">{{ todo.title }}</h4>
            <span
              class="priority-badge"
              [class.high]="todo.priority === 'high'"
              [class.medium]="todo.priority === 'medium'"
              [class.low]="todo.priority === 'low'"
            >
              {{ todo.priority | priority }}
            </span>
          </div>
          @if (todo.description) {
            <p class="todo-description line-through">{{ todo.description }}</p>
          }
          <div class="todo-footer">
            <span>Terminé le {{ todo.updatedAt | date: 'dd/MM/yyyy' }}</span>
          </div>
        </div>
      }
    </div>
  </div>
</div>
